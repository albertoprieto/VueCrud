import{_ as z,r,k as j,l as M,c as g,a as l,b as s,d as i,w as d,m as q,n as G,o as V,i as u,g as n,s as c,p as T,t as C,e as H,q as S,v as $,j as y,x as J,y as Q,z as R}from"./index-d7sXuZmh.js";import"./FileSaver.min-BCxzAtLx.js";const W={class:"articulos"},Y={class:"actions"},Z={class:"articulos-card"},ee={key:0},oe={key:1},le={class:"modal-content"},ae={class:"modal-title"},se={class:"form-grid"},ie={class:"form-row"},te={class:"form-col"},re={class:"form-group"},de={class:"form-group"},ue={key:0,class:"error-text"},ne={class:"form-group"},ce={key:0,class:"error-text"},pe={class:"form-group"},me={class:"form-group"},ve={class:"form-col"},fe={class:"form-group"},be={class:"form-group"},ge={class:"form-group"},Ve={class:"form-group"},Ce={class:"form-group"},Ae={class:"modal-actions"},we={class:"dialog-content"},ke={class:"modal-actions"},Se={class:"dialog-content"},ye={class:"modal-actions"},Ue={__name:"Articulos",setup(_e){const U=r([]),_=r([]),w=r(!0),p=r(!1),a=r({id:null,sku:"",nombre:"",descripcion:"",tipo:"",precioVenta:"",unidad:"",impuesto:"",precioCompra:"",codigoSat:"",codigoUnidadSat:""}),m=r(""),h=r("nombre"),D=r(1),v=r(!1),A=r(""),b=r(!1),N=r(null),k=async()=>{w.value=!0;try{U.value=await q(),_.value=await G()}finally{w.value=!1}};j(k);const x=M(()=>{const t={};return _.value.forEach(e=>{t[e.articulo_nombre]||(t[e.articulo_nombre]=[]),t[e.articulo_nombre].push(e)}),U.value.map(e=>{const f=(t[e.nombre]||[]).filter(K=>K.status==="Disponible").length;return Number(e.precioVenta),{...e,existencias:f}})}),E=t=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(t)||0),L=M(()=>m.value?x.value.filter(t=>{var e,o,f;return((e=t.nombre)==null?void 0:e.toLowerCase().includes(m.value.toLowerCase()))||((o=t.sku)==null?void 0:o.toLowerCase().includes(m.value.toLowerCase()))||((f=t.descripcion)==null?void 0:f.toLowerCase().includes(m.value.toLowerCase()))}):x.value),I=()=>{a.value={id:null,sku:"",nombre:"",descripcion:"",tipo:"",precioVenta:"",unidad:"",impuesto:""},p.value=!0},B=()=>{p.value=!1},O=async()=>{if(!a.value.nombre||!a.value.sku){A.value="Por favor, complete los campos obligatorios.",v.value=!0;return}try{const t={...a.value,codigo:a.value.codigo??"",pagina:a.value.pagina??""};a.value.id?await J(t):await Q(t),p.value=!1,await k()}catch{A.value="Error al guardar el artículo.",v.value=!0}},P=t=>{a.value={...t},p.value=!0},F=t=>{N.value=t,b.value=!0},X=async t=>{try{await R(t),await k(),b.value=!1}catch{A.value="Error al eliminar el artículo.",v.value=!0}};return(t,e)=>(V(),g("div",W,[e[28]||(e[28]=l("h2",null,"Artículos",-1)),l("div",Y,[s(i(u),{label:"Agregar Artículo",icon:"pi pi-plus",onClick:I}),s(i(n),{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),placeholder:"Buscar...",class:"ml-2"},null,8,["modelValue"])]),l("div",Z,[s(i(H),{value:L.value,sortField:h.value,sortOrder:D.value,responsiveLayout:"scroll",loading:w.value},{default:d(()=>[s(i(c),{field:"sku",header:"SKU",sortable:""}),s(i(c),{field:"tipo",header:"Tipo",sortable:""}),s(i(c),{field:"precioVenta",header:"Precio de venta"},{body:d(o=>[T(C(E(o.data.precioVenta)),1)]),_:1}),s(i(c),{header:"Existencias en mano"},{body:d(o=>[o.data.tipo&&o.data.tipo.toLowerCase()==="servicio"?(V(),g("span",ee,"NA")):(V(),g("span",oe,C(o.data.existencias),1))]),_:1}),s(i(c),{field:"precioCompra",header:"Precio de compra"},{body:d(o=>[T(C(E(o.data.precioCompra)),1)]),_:1}),s(i(c),{field:"codigoSat",header:"Código SAT",sortable:""}),s(i(c),{field:"codigoUnidadSat",header:"Código unidad SAT",sortable:""}),s(i(c),{header:"Acciones"},{body:d(o=>[s(i(u),{icon:"pi pi-pencil",class:"p-button-text",onClick:f=>P(o.data)},null,8,["onClick"]),s(i(u),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:f=>F(o.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value","sortField","sortOrder","loading"])]),s(i(y),{visible:p.value,"onUpdate:visible":e[11]||(e[11]=o=>p.value=o),header:a.value.id?"Editar Artículo":"Nuevo Artículo",modal:!0,closable:!0,class:"custom-modal"},{default:d(()=>[l("div",le,[l("h3",ae,C(a.value.id?"Editar Artículo":"Nuevo Artículo"),1),l("div",se,[l("div",ie,[l("div",te,[l("div",re,[e[17]||(e[17]=l("label",{for:"tipo"},"Tipo:",-1)),s(i(S),{id:"tipo",modelValue:a.value.tipo,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.tipo=o),options:["Bienes","Servicio"],placeholder:"Selecciona tipo",class:"w-full"},null,8,["modelValue"])]),l("div",de,[e[18]||(e[18]=l("label",{for:"nombre"},"Nombre:",-1)),s(i(n),{id:"nombre",modelValue:a.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.nombre=o),placeholder:"Nombre del artículo",class:"w-full"},null,8,["modelValue"]),a.value.nombre?$("",!0):(V(),g("small",ue,"Obligatorio."))]),l("div",ne,[e[19]||(e[19]=l("label",{for:"sku"},"SKU:",-1)),s(i(n),{id:"sku",modelValue:a.value.sku,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.sku=o),placeholder:"SKU o código interno",class:"w-full"},null,8,["modelValue"]),a.value.sku?$("",!0):(V(),g("small",ce,"Obligatorio."))]),l("div",pe,[e[20]||(e[20]=l("label",{for:"unidad"},"Unidad:",-1)),s(i(S),{id:"unidad",modelValue:a.value.unidad,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.unidad=o),options:["pieza","servicio","kg","litro"],placeholder:"Selecciona unidad",class:"w-full"},null,8,["modelValue"])]),l("div",me,[e[21]||(e[21]=l("label",{for:"precioVenta"},"Precio de venta (MXN):",-1)),s(i(n),{id:"precioVenta",modelValue:a.value.precioVenta,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.precioVenta=o),placeholder:"Precio de venta",class:"w-full"},null,8,["modelValue"])])]),l("div",ve,[l("div",fe,[e[22]||(e[22]=l("label",{for:"impuesto"},"Impuesto:",-1)),s(i(S),{id:"impuesto",modelValue:a.value.impuesto,"onUpdate:modelValue":e[6]||(e[6]=o=>a.value.impuesto=o),options:["IVA 16%","IVA 0%","Exento"],placeholder:"Selecciona impuesto",class:"w-full"},null,8,["modelValue"])]),l("div",be,[e[23]||(e[23]=l("label",{for:"descripcion"},"Descripción:",-1)),s(i(n),{id:"descripcion",modelValue:a.value.descripcion,"onUpdate:modelValue":e[7]||(e[7]=o=>a.value.descripcion=o),placeholder:"Descripción (opcional)",class:"w-full"},null,8,["modelValue"])]),l("div",ge,[e[24]||(e[24]=l("label",{for:"precioCompra"},"Precio de compra (MXN):",-1)),s(i(n),{id:"precioCompra",modelValue:a.value.precioCompra,"onUpdate:modelValue":e[8]||(e[8]=o=>a.value.precioCompra=o),placeholder:"Precio de compra",class:"w-full"},null,8,["modelValue"])]),l("div",Ve,[e[25]||(e[25]=l("label",{for:"codigoSat"},"Código artículo SAT:",-1)),s(i(n),{id:"codigoSat",modelValue:a.value.codigoSat,"onUpdate:modelValue":e[9]||(e[9]=o=>a.value.codigoSat=o),placeholder:"Código SAT",class:"w-full"},null,8,["modelValue"])]),l("div",Ce,[e[26]||(e[26]=l("label",{for:"codigoUnidadSat"},"Código unidad SAT:",-1)),s(i(n),{id:"codigoUnidadSat",modelValue:a.value.codigoUnidadSat,"onUpdate:modelValue":e[10]||(e[10]=o=>a.value.codigoUnidadSat=o),placeholder:"Código unidad SAT",class:"w-full"},null,8,["modelValue"])])])])]),l("div",Ae,[s(i(u),{label:"Guardar",icon:"pi pi-save",onClick:O}),s(i(u),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:B})])])]),_:1},8,["visible","header"]),s(i(y),{visible:v.value,"onUpdate:visible":e[13]||(e[13]=o=>v.value=o),header:"Error",modal:!0,closable:!1},{default:d(()=>[l("div",we,[l("p",null,C(A.value),1),l("div",ke,[s(i(u),{label:"Aceptar",icon:"pi pi-check",onClick:e[12]||(e[12]=o=>v.value=!1)})])])]),_:1},8,["visible"]),s(i(y),{visible:b.value,"onUpdate:visible":e[16]||(e[16]=o=>b.value=o),header:"Confirmar Eliminación",modal:!0,closable:!1},{default:d(()=>[l("div",Se,[e[27]||(e[27]=l("p",null,"¿Eliminar este artículo?",-1)),l("div",ye,[s(i(u),{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:e[14]||(e[14]=o=>X(N.value))}),s(i(u),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:e[15]||(e[15]=o=>b.value=!1)})])])]),_:1},8,["visible"])]))}},Ee=z(Ue,[["__scopeId","data-v-c6fe3023"]]);export{Ee as default};
