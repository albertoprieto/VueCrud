import{r as s,k as y,c as D,a as m,b as i,d as l,w as u,m as N,o as M,i as t,s as b,n as B,t as A,e as T,g as j,I as G,j as k,J}from"./index-Dfk-US5Q.js";import{g as R,u as S,a as h,d as q}from"./ubicacionesService-B8ot2R83.js";const z={class:"ubicaciones"},L={__name:"Ubicaciones",setup(F){const w=J(),f=s([]),v=s(!0),c=s(!1),r=s(!1),d=s(!1),n=s({id:null,nombre:"",descripcion:""}),U=s(null),g=s({}),p=async()=>{v.value=!0,f.value=await R();const o=await N(),e={};o.forEach(a=>{a.ubicacion_id!=null&&(e[a.ubicacion_id]=(e[a.ubicacion_id]||0)+1)}),g.value=e,v.value=!1},$=async()=>{d.value?await S(n.value.id,n.value):await h(n.value),c.value=!1,await p(),n.value={id:null,nombre:"",descripcion:""},d.value=!1},V=o=>{n.value={...o},c.value=!0,d.value=!0},I=o=>{U.value=o,r.value=!0},E=async()=>{await q(U.value),r.value=!1,await p()},x=o=>{w.push({name:"UbicacionImeis",params:{id:o.id}})};return y(p),(o,e)=>(M(),D("div",z,[e[8]||(e[8]=m("h2",null,"Ubicaciones (Bodegas)",-1)),i(l(t),{label:"Agregar Ubicación",icon:"pi pi-plus",onClick:e[0]||(e[0]=a=>c.value=!0)}),i(l(T),{value:f.value,loading:v.value},{default:u(()=>[i(l(b),{field:"nombre",header:"Nombre"}),i(l(b),{field:"descripcion",header:"Descripción"}),i(l(b),{header:"IMEIs asignados"},{body:u(a=>[B(A(g.value[a.data.id]||0),1)]),_:1}),i(l(b),{header:"Acciones"},{body:u(a=>[i(l(t),{icon:"pi pi-pencil",class:"p-button-text",onClick:C=>V(a.data)},null,8,["onClick"]),i(l(t),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:C=>I(a.data.id)},null,8,["onClick"]),i(l(t),{label:"Ver IMEIs",class:"p-button-text p-button-info",onClick:C=>x(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),i(l(k),{visible:c.value,"onUpdate:visible":e[4]||(e[4]=a=>c.value=a),header:d.value?"Editar Ubicación":"Nueva Ubicación",modal:!0},{footer:u(()=>[i(l(t),{label:"Cancelar",onClick:e[3]||(e[3]=a=>c.value=!1)}),i(l(t),{label:"Guardar",onClick:$})]),default:u(()=>[m("div",null,[i(l(j),{modelValue:n.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.nombre=a),placeholder:"Nombre",class:"mb-2 w-full"},null,8,["modelValue"]),i(l(G),{modelValue:n.value.descripcion,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.descripcion=a),placeholder:"Descripción",class:"w-full"},null,8,["modelValue"])])]),_:1},8,["visible","header"]),i(l(k),{visible:r.value,"onUpdate:visible":e[6]||(e[6]=a=>r.value=a),header:"Confirmar",modal:!0},{footer:u(()=>[i(l(t),{label:"Cancelar",onClick:e[5]||(e[5]=a=>r.value=!1)}),i(l(t),{label:"Eliminar",class:"p-button-danger",onClick:E})]),default:u(()=>[e[7]||(e[7]=m("span",null,"¿Eliminar esta ubicación?",-1))]),_:1},8,["visible"])]))}};export{L as default};
