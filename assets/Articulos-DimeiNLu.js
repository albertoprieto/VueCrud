import{g as P,u as X,a as j,d as z}from"./articulosService-DYFFFfM1.js";import{_ as G,r,k as q,l as H,c as C,a as o,b as s,d as a,w as b,o as y,i as u,g as V,s as m,e as J,t as S,m as _,n as $,j as x}from"./index-9q8L-fBU.js";import{u as U,w as Q,F as R}from"./FileSaver.min-Bul9EBtc.js";const W={class:"articulos"},Y={class:"actions"},Z={class:"articulos-card"},ee={class:"modal-content"},le={class:"modal-title"},oe={class:"form-grid"},se={class:"form-col"},ae={class:"form-group"},te={class:"form-group"},ie={key:0,class:"error-text"},re={class:"form-group"},ue={key:0,class:"error-text"},ne={class:"form-group"},de={class:"form-col"},ce={class:"form-group"},pe={class:"form-group"},ve={class:"form-group"},me={class:"modal-actions"},fe={class:"dialog-content"},be={class:"modal-actions"},Ve={class:"dialog-content"},ke={class:"modal-actions"},we={__name:"Articulos",setup(ge){const w=r([]),g=r(!0),c=r(!1),t=r({id:null,sku:"",nombre:"",descripcion:"",tipo:"",precioVenta:"",unidad:"",impuesto:""}),p=r(""),h=r("nombre"),D=r(1),v=r(!1),k=r(""),f=r(!1),E=r(null),A=async()=>{g.value=!0;try{w.value=await P()}finally{g.value=!1}};q(A);const M=()=>{t.value={id:null,sku:"",nombre:"",descripcion:"",tipo:"",precioVenta:"",unidad:"",impuesto:""},c.value=!0},B=()=>{c.value=!1},L=async()=>{if(!t.value.nombre||!t.value.sku){k.value="Por favor, complete los campos obligatorios.",v.value=!0;return}try{t.value.id?await X({...t.value}):await j({...t.value}),c.value=!1,await A()}catch{k.value="Error al guardar el artículo.",v.value=!0}},F=i=>{t.value={...i},c.value=!0},I=i=>{E.value=i,f.value=!0},O=async i=>{try{await z(i),await A(),f.value=!1}catch{k.value="Error al eliminar el artículo.",v.value=!0}},T=()=>{const i=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}),e=N.value.map(d=>({SKU:d.sku,Nombre:d.nombre,Descripción:d.descripcion,Tipo:d.tipo,Unidad:d.unidad,"Precio de venta":i.format(Number(d.precioVenta)||0),Impuesto:d.impuesto})),l=U.json_to_sheet(e),n=U.book_new();U.book_append_sheet(n,l,"Artículos");const K=Q(n,{bookType:"xlsx",type:"array"});R.saveAs(new Blob([K],{type:"application/octet-stream"}),"articulos.xlsx")},N=H(()=>p.value?w.value.filter(i=>{var e,l,n;return((e=i.nombre)==null?void 0:e.toLowerCase().includes(p.value.toLowerCase()))||((l=i.sku)==null?void 0:l.toLowerCase().includes(p.value.toLowerCase()))||((n=i.descripcion)==null?void 0:n.toLowerCase().includes(p.value.toLowerCase()))}):w.value);return(i,e)=>(y(),C("div",W,[e[22]||(e[22]=o("h2",null,"Artículos",-1)),o("div",Y,[s(a(u),{label:"Agregar Artículo",icon:"pi pi-plus",onClick:M}),s(a(u),{label:"Exportar Excel",icon:"pi pi-file-excel",class:"p-button-success",onClick:T}),s(a(V),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),placeholder:"Buscar...",class:"ml-2"},null,8,["modelValue"])]),o("div",Z,[s(a(J),{value:N.value,sortField:h.value,sortOrder:D.value,responsiveLayout:"scroll",loading:g.value},{default:b(()=>[s(a(m),{field:"sku",header:"SKU",sortable:""}),s(a(m),{field:"nombre",header:"Nombre",sortable:""}),s(a(m),{field:"descripcion",header:"Descripción",sortable:""}),s(a(m),{field:"tipo",header:"Tipo",sortable:""}),s(a(m),{field:"precioVenta",header:"Precio de venta",sortable:""}),s(a(m),{header:"Acciones"},{body:b(l=>[s(a(u),{icon:"pi pi-pencil",class:"p-button-text",onClick:n=>F(l.data)},null,8,["onClick"]),s(a(u),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:n=>I(l.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value","sortField","sortOrder","loading"])]),s(a(x),{visible:c.value,"onUpdate:visible":e[8]||(e[8]=l=>c.value=l),header:t.value.id?"Editar Artículo":"Nuevo Artículo",modal:!0,closable:!0,class:"custom-modal"},{default:b(()=>[o("div",ee,[o("h3",le,S(t.value.id?"Editar Artículo":"Nuevo Artículo"),1),o("div",oe,[o("div",se,[o("div",ae,[e[14]||(e[14]=o("label",{for:"tipo"},"Tipo:",-1)),s(a(_),{id:"tipo",modelValue:t.value.tipo,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.tipo=l),options:["Bienes","Servicio"],placeholder:"Selecciona tipo",class:"w-full"},null,8,["modelValue"])]),o("div",te,[e[15]||(e[15]=o("label",{for:"nombre"},"Nombre:",-1)),s(a(V),{id:"nombre",modelValue:t.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.nombre=l),placeholder:"Nombre del artículo",class:"w-full"},null,8,["modelValue"]),t.value.nombre?$("",!0):(y(),C("small",ie,"Obligatorio."))]),o("div",re,[e[16]||(e[16]=o("label",{for:"sku"},"SKU:",-1)),s(a(V),{id:"sku",modelValue:t.value.sku,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.sku=l),placeholder:"SKU o código interno",class:"w-full"},null,8,["modelValue"]),t.value.sku?$("",!0):(y(),C("small",ue,"Obligatorio."))]),o("div",ne,[e[17]||(e[17]=o("label",{for:"unidad"},"Unidad:",-1)),s(a(_),{id:"unidad",modelValue:t.value.unidad,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.unidad=l),options:["pieza","servicio","kg","litro"],placeholder:"Selecciona unidad",class:"w-full"},null,8,["modelValue"])])]),o("div",de,[o("div",ce,[e[18]||(e[18]=o("label",{for:"precioVenta"},"Precio de venta (MXN):",-1)),s(a(V),{id:"precioVenta",modelValue:t.value.precioVenta,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.precioVenta=l),placeholder:"Precio de venta",class:"w-full"},null,8,["modelValue"])]),o("div",pe,[e[19]||(e[19]=o("label",{for:"impuesto"},"Impuesto:",-1)),s(a(_),{id:"impuesto",modelValue:t.value.impuesto,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.impuesto=l),options:["IVA 16%","IVA 0%","Exento"],placeholder:"Selecciona impuesto",class:"w-full"},null,8,["modelValue"])]),o("div",ve,[e[20]||(e[20]=o("label",{for:"descripcion"},"Descripción:",-1)),s(a(V),{id:"descripcion",modelValue:t.value.descripcion,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.descripcion=l),placeholder:"Descripción (opcional)",class:"w-full"},null,8,["modelValue"])])])]),o("div",me,[s(a(u),{label:"Guardar",icon:"pi pi-save",onClick:L}),s(a(u),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:B})])])]),_:1},8,["visible","header"]),s(a(x),{visible:v.value,"onUpdate:visible":e[10]||(e[10]=l=>v.value=l),header:"Error",modal:!0,closable:!1},{default:b(()=>[o("div",fe,[o("p",null,S(k.value),1),o("div",be,[s(a(u),{label:"Aceptar",icon:"pi pi-check",onClick:e[9]||(e[9]=l=>v.value=!1)})])])]),_:1},8,["visible"]),s(a(x),{visible:f.value,"onUpdate:visible":e[13]||(e[13]=l=>f.value=l),header:"Confirmar Eliminación",modal:!0,closable:!1},{default:b(()=>[o("div",Ve,[e[21]||(e[21]=o("p",null,"¿Eliminar este artículo?",-1)),o("div",ke,[s(a(u),{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:e[11]||(e[11]=l=>O(E.value))}),s(a(u),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:e[12]||(e[12]=l=>f.value=!1)})])])]),_:1},8,["visible"])]))}},_e=G(we,[["__scopeId","data-v-f79be6f5"]]);export{_e as default};
