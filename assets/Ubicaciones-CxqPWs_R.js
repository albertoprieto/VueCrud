import{_ as N,r as s,k as y,c as D,a as m,b as i,d as l,w as c,A as M,n as _,o as B,i as t,s as b,p as A,t as T,e as j,g as G,M as O,j as k,N as Q,O as R,P as S,Q as h}from"./index-BZtuHe24.js";const q={class:"ubicaciones"},z={__name:"Ubicaciones",setup(F){const w=Q(),f=s([]),v=s(!0),u=s(!1),r=s(!1),d=s(!1),n=s({id:null,nombre:"",descripcion:""}),U=s(null),g=s({}),p=async()=>{v.value=!0,f.value=await M();const o=await _(),e={};o.forEach(a=>{a.ubicacion_id!=null&&(e[a.ubicacion_id]=(e[a.ubicacion_id]||0)+1)}),g.value=e,v.value=!1},$=async()=>{d.value?await R(n.value.id,n.value):await S(n.value),u.value=!1,await p(),n.value={id:null,nombre:"",descripcion:""},d.value=!1},V=o=>{n.value={...o},u.value=!0,d.value=!0},I=o=>{U.value=o,r.value=!0},x=async()=>{await h(U.value),r.value=!1,await p()},E=o=>{w.push({name:"UbicacionImeis",params:{id:o.id}})};return y(p),(o,e)=>(B(),D("div",q,[e[8]||(e[8]=m("h2",null,"Ubicaciones (Bodegas)",-1)),i(l(t),{label:"Agregar Ubicación",icon:"pi pi-plus",onClick:e[0]||(e[0]=a=>u.value=!0)}),i(l(j),{value:f.value,loading:v.value},{default:c(()=>[i(l(b),{field:"nombre",header:"Nombre"}),i(l(b),{field:"descripcion",header:"Descripción"}),i(l(b),{header:"IMEIs asignados"},{body:c(a=>[A(T(g.value[a.data.id]||0),1)]),_:1}),i(l(b),{header:"Acciones"},{body:c(a=>[i(l(t),{icon:"pi pi-pencil",class:"p-button-text",onClick:C=>V(a.data)},null,8,["onClick"]),i(l(t),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:C=>I(a.data.id)},null,8,["onClick"]),i(l(t),{label:"Ver IMEIs",class:"p-button-text p-button-info",onClick:C=>E(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),i(l(k),{visible:u.value,"onUpdate:visible":e[4]||(e[4]=a=>u.value=a),header:d.value?"Editar Ubicación":"Nueva Ubicación",modal:!0,class:"ubicaciones-dialog"},{footer:c(()=>[i(l(t),{label:"Cancelar",onClick:e[3]||(e[3]=a=>u.value=!1)}),i(l(t),{label:"Guardar",onClick:$})]),default:c(()=>[m("div",null,[i(l(G),{modelValue:n.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.nombre=a),placeholder:"Nombre",class:"mb-2 w-full"},null,8,["modelValue"]),i(l(O),{modelValue:n.value.descripcion,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.descripcion=a),placeholder:"Descripción",class:"w-full"},null,8,["modelValue"])])]),_:1},8,["visible","header"]),i(l(k),{visible:r.value,"onUpdate:visible":e[6]||(e[6]=a=>r.value=a),header:"Confirmar",modal:!0,class:"ubicaciones-dialog"},{footer:c(()=>[i(l(t),{label:"Cancelar",onClick:e[5]||(e[5]=a=>r.value=!1)}),i(l(t),{label:"Eliminar",class:"p-button-danger",onClick:x})]),default:c(()=>[e[7]||(e[7]=m("span",null,"¿Eliminar esta ubicación?",-1))]),_:1},8,["visible"])]))}},J=N(z,[["__scopeId","data-v-c5c25cb7"]]);export{J as default};
