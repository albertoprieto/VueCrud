import{_ as y,r as s,k as D,c as N,a as m,b as i,d as l,w as c,m as M,o as _,i as t,s as b,n as B,t as A,e as G,g as T,G as j,j as k,H}from"./index-CYB56wGJ.js";import{g as R,u as S,b as h,d as q}from"./ubicacionesService-CH5Z2c13.js";const z={class:"ubicaciones"},F={__name:"Ubicaciones",setup(J){const w=H(),f=s([]),v=s(!0),u=s(!1),r=s(!1),d=s(!1),n=s({id:null,nombre:"",descripcion:""}),U=s(null),g=s({}),p=async()=>{v.value=!0,f.value=await R();const o=await M(),e={};o.forEach(a=>{a.ubicacion_id!=null&&(e[a.ubicacion_id]=(e[a.ubicacion_id]||0)+1)}),g.value=e,v.value=!1},$=async()=>{d.value?await S(n.value.id,n.value):await h(n.value),u.value=!1,await p(),n.value={id:null,nombre:"",descripcion:""},d.value=!1},V=o=>{n.value={...o},u.value=!0,d.value=!0},I=o=>{U.value=o,r.value=!0},x=async()=>{await q(U.value),r.value=!1,await p()},E=o=>{w.push({name:"UbicacionImeis",params:{id:o.id}})};return D(p),(o,e)=>(_(),N("div",z,[e[8]||(e[8]=m("h2",null,"Ubicaciones (Bodegas)",-1)),i(l(t),{label:"Agregar Ubicación",icon:"pi pi-plus",onClick:e[0]||(e[0]=a=>u.value=!0)}),i(l(G),{value:f.value,loading:v.value},{default:c(()=>[i(l(b),{field:"nombre",header:"Nombre"}),i(l(b),{field:"descripcion",header:"Descripción"}),i(l(b),{header:"IMEIs asignados"},{body:c(a=>[B(A(g.value[a.data.id]||0),1)]),_:1}),i(l(b),{header:"Acciones"},{body:c(a=>[i(l(t),{icon:"pi pi-pencil",class:"p-button-text",onClick:C=>V(a.data)},null,8,["onClick"]),i(l(t),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:C=>I(a.data.id)},null,8,["onClick"]),i(l(t),{label:"Ver IMEIs",class:"p-button-text p-button-info",onClick:C=>E(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),i(l(k),{visible:u.value,"onUpdate:visible":e[4]||(e[4]=a=>u.value=a),header:d.value?"Editar Ubicación":"Nueva Ubicación",modal:!0,class:"ubicaciones-dialog"},{footer:c(()=>[i(l(t),{label:"Cancelar",onClick:e[3]||(e[3]=a=>u.value=!1)}),i(l(t),{label:"Guardar",onClick:$})]),default:c(()=>[m("div",null,[i(l(T),{modelValue:n.value.nombre,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.nombre=a),placeholder:"Nombre",class:"mb-2 w-full"},null,8,["modelValue"]),i(l(j),{modelValue:n.value.descripcion,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.descripcion=a),placeholder:"Descripción",class:"w-full"},null,8,["modelValue"])])]),_:1},8,["visible","header"]),i(l(k),{visible:r.value,"onUpdate:visible":e[6]||(e[6]=a=>r.value=a),header:"Confirmar",modal:!0,class:"ubicaciones-dialog"},{footer:c(()=>[i(l(t),{label:"Cancelar",onClick:e[5]||(e[5]=a=>r.value=!1)}),i(l(t),{label:"Eliminar",class:"p-button-danger",onClick:x})]),default:c(()=>[e[7]||(e[7]=m("span",null,"¿Eliminar esta ubicación?",-1))]),_:1},8,["visible"])]))}},O=y(F,[["__scopeId","data-v-c5c25cb7"]]);export{O as default};
