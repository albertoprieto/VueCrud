import{_ as D,r as t,o as h,y as A,c as T,a as n,b as l,u as i,w as v,d as N,E as S,e as E,q,h as o,s as p,t as F,I as j,g as z,i as H,j as O,k as x,A as R,av as G,H as J,L as K}from"./index-XKA0IK-S.js";const Q={class:"buscar-imei-container"},W={class:"buscar-imei-filtros"},X={class:"modal-actions"},Y={style:{padding:"1.5rem","text-align":"center"}},Z={class:"modal-actions"},P={__name:"BuscarImei",setup(ee){const C=t([]),u=t(""),w=t(!1),c=t(!1),b=t(null),d=t(!1),f=t(null),I=t([]),r=t(null),g=async()=>{w.value=!0;const s=await N.get("https://api.gpsubicacionapi.com/buscar-imei?digitos=");C.value=s.data,w.value=!1},V=async()=>{I.value=await S()};h(async()=>{await g(),await V()});const $=A(()=>{if(!u.value)return C.value;const s=u.value.toLowerCase();return C.value.filter(e=>{var a,m,y,k;return((a=e.imei)==null?void 0:a.toLowerCase().includes(s))||((m=e.imei)==null?void 0:m.slice(-5).includes(s))||((y=e.articulo_nombre)==null?void 0:y.toLowerCase().includes(s))||((k=e.ubicacion)==null?void 0:k.toLowerCase().includes(s))})}),M=async s=>{await K(s),await g()},_=s=>{b.value=s,c.value=!0},L=async()=>{b.value&&(await G(b.value),await g(),c.value=!1,b.value=null)},U=s=>{f.value=s,r.value=null,d.value=!0},B=async()=>{!f.value||!r.value||(await J(r.value.id,[f.value]),await g(),d.value=!1,f.value=null,r.value=null)};return(s,e)=>(E(),T("div",Q,[e[9]||(e[9]=n("h2",{class:"buscar-imei-title"},"Buscar IMEI",-1)),n("div",W,[l(i(q),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),placeholder:"Filtra por últimos dígitos, artículo o ubicación...",class:"buscar-imei-input"},null,8,["modelValue"]),l(i(o),{label:"Limpiar",icon:"pi pi-times",onClick:e[1]||(e[1]=a=>u.value=""),class:"ml-2"})]),l(i(O),{value:$.value,paginator:!0,rows:10,responsiveLayout:"scroll",class:"buscar-imei-table",loading:w.value,stripedRows:"",rowsPerPageOptions:[10,20,50],emptyMessage:"No se encontraron IMEIs."},{default:v(()=>[l(i(p),{field:"imei",header:"IMEI",sortable:""}),l(i(p),{field:"articulo_nombre",header:"Artículo",sortable:""}),l(i(p),{field:"ubicacion",header:"Ubicación",sortable:""}),l(i(p),{field:"status",header:"Estado"},{body:v(a=>[n("span",{class:j({"imei-disponible":a.data.status==="Disponible","imei-vendido":a.data.status==="Vendido","imei-devuelto":a.data.status==="Devuelto"})},F(a.data.status),3)]),_:1}),l(i(p),{header:"Acciones"},{body:v(a=>[a.data.status==="Vendido"?(E(),z(i(o),{key:0,label:"Devolver",icon:"pi pi-undo",class:"p-button-text p-button-warning",onClick:m=>M(a.data.imei)},null,8,["onClick"])):H("",!0),l(i(o),{label:"Transferir",icon:"pi pi-exchange",class:"p-button-text p-button-info ml-2",onClick:m=>U(a.data.imei)},null,8,["onClick"]),l(i(o),{label:"Eliminar",icon:"pi pi-trash",class:"p-button-text p-button-danger ml-2",onClick:m=>_(a.data.imei)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),l(i(x),{visible:c.value,"onUpdate:visible":e[3]||(e[3]=a=>c.value=a),header:"Confirmar Eliminación",modal:!0,closable:!1},{default:v(()=>[e[7]||(e[7]=n("div",{style:{padding:"1.5rem","text-align":"center"}},[n("span",null,"¿Seguro que deseas eliminar este IMEI?")],-1)),n("div",X,[l(i(o),{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:L}),l(i(o),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary ml-2",onClick:e[2]||(e[2]=a=>c.value=!1)})])]),_:1},8,["visible"]),l(i(x),{visible:d.value,"onUpdate:visible":e[6]||(e[6]=a=>d.value=a),header:"Transferir IMEI",modal:!0,closable:!1},{default:v(()=>[n("div",Y,[e[8]||(e[8]=n("span",null,"Selecciona la ubicación destino para transferir el IMEI:",-1)),l(i(R),{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value=a),options:I.value,optionLabel:"nombre",placeholder:"Selecciona ubicación",class:"w-full mt-3"},null,8,["modelValue","options"])]),n("div",Z,[l(i(o),{label:"Transferir",icon:"pi pi-exchange",class:"p-button-info",onClick:B,disabled:!r.value},null,8,["disabled"]),l(i(o),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary ml-2",onClick:e[5]||(e[5]=a=>d.value=!1)})])]),_:1},8,["visible"])]))}},ie=D(P,[["__scopeId","data-v-151f1f35"]]);export{ie as default};
