import{d as $,_ as O,r as n,o as A,c as r,a as i,b as a,u as s,p as j,w as F,af as L,e as m,B as P,x as u,ad as T,am as z,g as V,t as G,k as Y,a3 as H}from"./index-CSYRPmdx.js";const C="https://api.gpsubicacionapi.com/reportes-servicio",J=async d=>await $.post(C,d),K=async d=>(await $.get(`${C}?asignacion_id=${d}`)).data,Q={class:"reporte-servicio-container"},W={key:0,class:"loader-overlay"},X={key:1},Z={key:0,class:"alert-existente"},h={key:1},ll={class:"form-row"},el={class:"form-col"},ol={class:"form-group"},al={class:"form-group"},sl={class:"form-group"},il={class:"form-group"},ul={class:"form-group"},tl={class:"form-col"},dl={class:"form-group"},nl={class:"form-group"},rl={class:"form-group"},ml={class:"form-group"},pl={class:"form-group"},vl={class:"checkbox-group mb-2"},cl={class:"modal-actions"},fl={style:{padding:"1.5rem","text-align":"center"}},Vl={__name:"ReporteServicio",props:{asignacionId:Number,ventaDetalle:Object,cliente:Object},emits:["close","saved"],setup(d,{emit:b}){var I,_,R,x,k,D;const g=L(),E=Number(g.params.asignacionId),t=d,w=b,M=["Instalación","Reinstalación","Revisión","Desinstalación","Búsqueda"],N=["Efectivo","Transferencia","Depósito"],e=n({tipo_servicio:"",lugar_instalacion:"",marca:"",submarca:"",modelo:"",placas:"",color:"",numero_economico:"",equipo_plan:"",imei:"",serie:"",accesorios:"",sim_proveedor:"",sim_serie:"",sim_instalador:"",sim_telefono:"",bateria:"",ignicion:"",corte:"",ubicacion_corte:"",observaciones:"",plataforma:((_=(I=t.cliente)==null?void 0:I.plataformas)==null?void 0:_[0])||"",usuario:((x=(R=t.cliente)==null?void 0:R.usuarios)==null?void 0:x[0])||"",subtotal:((k=t.ventaDetalle)==null?void 0:k.total)||"",forma_pago:"",pagado:!1,nombre_cliente:((D=t.cliente)==null?void 0:D.nombre)||"",firma_cliente:"",nombre_instalador:"",firma_instalador:"",asignacion_id:t.asignacionId}),v=n(!1),p=n(!1),c=n(""),U=n(!1);async function y(){const f=await K(t.asignacionId||E);U.value=!!f}A(y);function S(){w("close")}async function q(){v.value=!0;try{e.value.asignacion_id=t.asignacionId||Number(g.params.asignacionId),await J(e.value),c.value="Reporte de servicio guardado correctamente.",w("saved"),await y(),S()}catch{c.value="Error al guardar el reporte de servicio."}finally{v.value=!1,p.value=!0}}return(f,l)=>{const B=H("Loader");return m(),r("div",Q,[l[44]||(l[44]=i("h2",{class:"reporte-title"},"Reporte de Servicio",-1)),i("form",{class:"reporte-form",onSubmit:j(q,["prevent"])},[v.value?(m(),r("div",W,[a(B)])):(m(),r("div",X,[U.value?(m(),r("div",Z," Ya existe un reporte de servicio para esta asignación. Elimínalo antes de crear uno nuevo. ")):(m(),r("div",h,[i("div",ll,[i("div",el,[i("div",ol,[l[32]||(l[32]=i("label",null,"Tipo de servicio",-1)),a(s(P),{modelValue:e.value.tipo_servicio,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.tipo_servicio=o),options:M,placeholder:"Selecciona",class:"w-full"},null,8,["modelValue"])]),i("div",al,[l[33]||(l[33]=i("label",null,"Lugar/Centro de instalación",-1)),a(s(u),{modelValue:e.value.lugar_instalacion,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.lugar_instalacion=o),class:"w-full",placeholder:"Opcional"},null,8,["modelValue"])]),l[34]||(l[34]=i("h4",{class:"section-title"},"Datos del vehículo",-1)),i("div",sl,[a(s(u),{modelValue:e.value.marca,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.marca=o),placeholder:"Marca",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.submarca,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.submarca=o),placeholder:"Submarca",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.modelo,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.modelo=o),placeholder:"Modelo",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.placas,"onUpdate:modelValue":l[5]||(l[5]=o=>e.value.placas=o),placeholder:"Placas",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.color,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.color=o),placeholder:"Color",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.numero_economico,"onUpdate:modelValue":l[7]||(l[7]=o=>e.value.numero_economico=o),placeholder:"Número económico",class:"w-full mb-2"},null,8,["modelValue"])]),l[35]||(l[35]=i("h4",{class:"section-title"},"Datos SIM (uso interno)",-1)),i("div",il,[a(s(u),{modelValue:e.value.sim_proveedor,"onUpdate:modelValue":l[8]||(l[8]=o=>e.value.sim_proveedor=o),placeholder:"Proveedor",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.sim_serie,"onUpdate:modelValue":l[9]||(l[9]=o=>e.value.sim_serie=o),placeholder:"Serie",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.sim_instalador,"onUpdate:modelValue":l[10]||(l[10]=o=>e.value.sim_instalador=o),placeholder:"Instalador",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.sim_telefono,"onUpdate:modelValue":l[11]||(l[11]=o=>e.value.sim_telefono=o),placeholder:"Teléfono",class:"w-full mb-2"},null,8,["modelValue"])]),l[36]||(l[36]=i("h4",{class:"section-title"},"Firmas y aviso",-1)),i("div",ul,[a(s(u),{modelValue:e.value.nombre_cliente,"onUpdate:modelValue":l[12]||(l[12]=o=>e.value.nombre_cliente=o),placeholder:"Nombre del cliente",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.firma_cliente,"onUpdate:modelValue":l[13]||(l[13]=o=>e.value.firma_cliente=o),placeholder:"Firma del cliente",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.nombre_instalador,"onUpdate:modelValue":l[14]||(l[14]=o=>e.value.nombre_instalador=o),placeholder:"Nombre del instalador",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.firma_instalador,"onUpdate:modelValue":l[15]||(l[15]=o=>e.value.firma_instalador=o),placeholder:"Firma del instalador",class:"w-full mb-2"},null,8,["modelValue"])])]),i("div",tl,[l[39]||(l[39]=i("h4",{class:"section-title"},"Datos del equipo",-1)),i("div",dl,[a(s(u),{modelValue:e.value.equipo_plan,"onUpdate:modelValue":l[16]||(l[16]=o=>e.value.equipo_plan=o),placeholder:"Equipo/Plan",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.imei,"onUpdate:modelValue":l[17]||(l[17]=o=>e.value.imei=o),placeholder:"IMEI",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.serie,"onUpdate:modelValue":l[18]||(l[18]=o=>e.value.serie=o),placeholder:"Serie",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.accesorios,"onUpdate:modelValue":l[19]||(l[19]=o=>e.value.accesorios=o),placeholder:"Accesorios adicionales",class:"w-full mb-2"},null,8,["modelValue"])]),l[40]||(l[40]=i("h4",{class:"section-title"},"Datos de conexión y corte",-1)),i("div",nl,[a(s(u),{modelValue:e.value.bateria,"onUpdate:modelValue":l[20]||(l[20]=o=>e.value.bateria=o),placeholder:"Batería",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.ignicion,"onUpdate:modelValue":l[21]||(l[21]=o=>e.value.ignicion=o),placeholder:"Ignición",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.corte,"onUpdate:modelValue":l[22]||(l[22]=o=>e.value.corte=o),placeholder:"Corte bomba/switch",class:"w-full mb-2"},null,8,["modelValue"]),a(s(u),{modelValue:e.value.ubicacion_corte,"onUpdate:modelValue":l[23]||(l[23]=o=>e.value.ubicacion_corte=o),placeholder:"Ubicación",class:"w-full mb-2"},null,8,["modelValue"])]),i("div",rl,[l[37]||(l[37]=i("label",null,"Observaciones de la unidad",-1)),a(s(T),{modelValue:e.value.observaciones,"onUpdate:modelValue":l[24]||(l[24]=o=>e.value.observaciones=o),rows:"2",class:"w-full"},null,8,["modelValue"])]),l[41]||(l[41]=i("h4",{class:"section-title"},"Plataforma y usuario",-1)),i("div",ml,[a(s(u),{modelValue:e.value.plataforma,"onUpdate:modelValue":l[25]||(l[25]=o=>e.value.plataforma=o),placeholder:"Plataforma",class:"w-full mb-2",disabled:!0},null,8,["modelValue"]),a(s(u),{modelValue:e.value.usuario,"onUpdate:modelValue":l[26]||(l[26]=o=>e.value.usuario=o),placeholder:"Usuario",class:"w-full mb-2",disabled:!0},null,8,["modelValue"])]),l[42]||(l[42]=i("h4",{class:"section-title"},"Venta y pago",-1)),i("div",pl,[a(s(u),{modelValue:e.value.subtotal,"onUpdate:modelValue":l[27]||(l[27]=o=>e.value.subtotal=o),placeholder:"Subtotal",class:"w-full mb-2",disabled:!0},null,8,["modelValue"]),a(s(P),{modelValue:e.value.forma_pago,"onUpdate:modelValue":l[28]||(l[28]=o=>e.value.forma_pago=o),options:N,placeholder:"Forma de pago",class:"w-full mb-2"},null,8,["modelValue"]),i("div",vl,[a(s(z),{modelValue:e.value.pagado,"onUpdate:modelValue":l[29]||(l[29]=o=>e.value.pagado=o),binary:!0,inputId:"pagado"},null,8,["modelValue"]),l[38]||(l[38]=i("label",{for:"pagado"},"Pagado",-1))])]),l[43]||(l[43]=i("div",{class:"form-group"},[i("small",null,"Aviso de privacidad: Sus datos serán tratados conforme a la ley...")],-1))])]),i("div",cl,[a(s(V),{label:"Guardar",icon:"pi pi-save",type:"submit"}),a(s(V),{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",type:"button",onClick:S})])]))]))],32),a(s(Y),{visible:p.value,"onUpdate:visible":l[31]||(l[31]=o=>p.value=o),header:"Resultado",modal:!0,closable:!1},{default:F(()=>[i("div",fl,[i("span",null,G(c.value),1)]),a(s(V),{label:"Aceptar",icon:"pi pi-check",onClick:l[30]||(l[30]=o=>p.value=!1),class:"mt-3"})]),_:1},8,["visible"])])}}},bl=O(Vl,[["__scopeId","data-v-fdd5a30d"]]),wl=Object.freeze(Object.defineProperty({__proto__:null,default:bl},Symbol.toStringTag,{value:"Module"}));export{bl as R,wl as a,K as g};
