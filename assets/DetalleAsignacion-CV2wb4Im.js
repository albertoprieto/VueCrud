import{_ as C,r as v,z as F,o as x,c as i,a as e,t as s,j as r,L as I,M as $,i as _,u as k,f,b as T,ap as B,e as t,g as y,ak as M}from"./index-D4-v7Pbq.js";import{g as E}from"./asignacionesService-B_j_1V0i.js";import{a as G,g as L}from"./ventasService-BIbRGUZH.js";import{g as O}from"./clientesService-CEpfwRfx.js";import{g as R,R as P}from"./ReporteServicio-D8qjp2AO.js";const U={class:"detalle-asignacion"},j={key:0},z={class:"asignacion-info"},q={class:"asignacion-value"},H={class:"asignacion-value"},J={class:"asignacion-value"},K={class:"asignacion-value"},Q={key:0,class:"venta-detalle-card"},W={class:"venta-detalle-info"},X={class:"venta-value"},Y={class:"venta-value"},Z={class:"venta-value"},h={class:"detalle-table"},ee={key:0},ae={key:0},le={key:3},ne={__name:"DetalleAsignacion",setup(se){const D=B(),w=M(),n=v(null),d=v(null),p=v([]),m=v(""),o=v(null),g=v(!1),N=F(()=>n.value&&new Date(n.value.fecha_servicio)<=new Date&&!o.value);async function S(){o.value=await R(n.value.id)}function V(){w.push({name:"reporte-servicio",params:{asignacionId:n.value.id}})}return x(async()=>{var a,c;const b=await E();if(n.value=b.find(u=>u.id==D.params.id),(a=n.value)!=null&&a.venta_id){const u=await G();d.value=u.find(l=>l.id==n.value.venta_id)||{},p.value=await L(n.value.venta_id)}if((c=n.value)!=null&&c.cliente_id){const l=(await O()).find(A=>A.id==n.value.cliente_id);m.value=l?l.nombre:""}o.value=await R(n.value.id)}),(b,a)=>{var c,u;return t(),i("div",U,[a[19]||(a[19]=e("h2",null,"Detalle de Asignación",-1)),n.value?(t(),i("div",j,[e("div",z,[e("div",null,[a[3]||(a[3]=e("span",{class:"asignacion-label"},"Técnico:",-1)),e("span",q,s(n.value.tecnico),1)]),e("div",null,[a[4]||(a[4]=e("span",{class:"asignacion-label"},"Fecha de servicio:",-1)),e("span",H,s(n.value.fecha_servicio),1)]),e("div",null,[a[5]||(a[5]=e("span",{class:"asignacion-label"},"Nota de venta:",-1)),e("span",J,s(n.value.venta_id),1)]),e("div",null,[a[6]||(a[6]=e("span",{class:"asignacion-label"},"Cliente:",-1)),e("span",K,s(m.value||n.value.cliente_id),1)])]),d.value?(t(),i("div",Q,[a[14]||(a[14]=e("h3",null,"Detalle de la Nota de Venta",-1)),e("div",W,[e("div",null,[a[7]||(a[7]=e("span",{class:"venta-label"},"Fecha:",-1)),e("span",X,s(((c=d.value.fecha)==null?void 0:c.split("T")[0])||d.value.fecha),1)]),e("div",null,[a[8]||(a[8]=e("span",{class:"venta-label"},"Observaciones:",-1)),e("span",Y,s(d.value.observaciones||"Sin observaciones"),1)]),e("div",null,[a[9]||(a[9]=e("span",{class:"venta-label"},"Total:",-1)),e("span",Z,"$"+s((u=d.value.total)==null?void 0:u.toFixed(2)),1)])]),e("table",h,[e("thead",null,[e("tr",null,[a[10]||(a[10]=e("th",null,"Artículo",-1)),a[11]||(a[11]=e("th",null,"Cantidad",-1)),a[12]||(a[12]=e("th",null,"Precio Unitario",-1)),a[13]||(a[13]=e("th",null,"Subtotal",-1)),p.value&&p.value.some(l=>l.imei)?(t(),i("th",ee,"IMEI")):r("",!0)])]),e("tbody",null,[(t(!0),i(I,null,$(p.value,l=>(t(),i("tr",{key:l.id},[e("td",null,s(l.articulo_nombre),1),e("td",null,s(l.cantidad),1),e("td",null,"$"+s(Number(l.precio_unitario).toFixed(2)),1),e("td",null,"$"+s((l.cantidad*l.precio_unitario).toFixed(2)),1),l.imei?(t(),i("td",ae,s(l.imei),1)):r("",!0)]))),128))])])])):r("",!0),N.value?(t(),_(k(y),{key:1,label:"Generar Reporte de Servicio",icon:"pi pi-file-edit",class:"p-button-success",onClick:V})):r("",!0),g.value?(t(),_(P,{key:2,asignacionId:n.value.id,visible:g.value,"onUpdate:visible":a[0]||(a[0]=l=>g.value=l),onClose:a[1]||(a[1]=l=>g.value=!1),onSaved:S},null,8,["asignacionId","visible"])):r("",!0),o.value?(t(),i("div",le,[a[18]||(a[18]=e("h3",null,"Reporte de Servicio",-1)),e("p",null,[a[15]||(a[15]=e("b",null,"Descripción:",-1)),f(" "+s(o.value.descripcion),1)]),e("p",null,[a[16]||(a[16]=e("b",null,"Observaciones:",-1)),f(" "+s(o.value.observaciones),1)]),e("p",null,[a[17]||(a[17]=e("b",null,"Fecha de reporte:",-1)),f(" "+s(o.value.fecha),1)])])):r("",!0)])):r("",!0),T(k(y),{label:"Regresar",icon:"pi pi-arrow-left",onClick:a[2]||(a[2]=l=>b.$router.back()),class:"btn-regresar"})])}}},de=C(ne,[["__scopeId","data-v-21d6a78c"]]);export{de as default};
