import{_ as y,r as o,k as w,c as $,a as x,b as a,w as n,d as t,o as b,s as c,p as g,t as h,i as k,e as D,D as F,v as S,j as B,m as T}from"./index-DAEkg-Eb.js";import{_ as H}from"./NotaVentaPDF-B6zGnI1d.js";import{a as j,g as A}from"./ventasService-D4Fig-dW.js";import{g as G}from"./clientesService-BgvouJXM.js";import"./_commonjsHelpers-Cpj98o6Y.js";const P={class:"historico-notas-container"},E={__name:"HistoricoNotasVenta",setup(I){const m=o([]),l=o(!0),r=o(!1),v=o(null),p=o(null),f=o([]),V={nombre:"GPSubicacion.com",direccion:"Guadalajara",rfc:"RFC123456"};w(async()=>{l.value=!0,m.value=await j(),l.value=!1});async function C(d){l.value=!0,v.value=d;const s=await A(d.id),e=await G();p.value=e.find(u=>u.id===d.cliente_id)||{};const i=await T();f.value=s.map(u=>{const _=i.find(N=>N.id===u.articulo_id)||{};return{...u,sku:_.sku,nombre:_.nombre}}),r.value=!0,l.value=!1}return(d,s)=>(b(),$("div",P,[s[2]||(s[2]=x("h2",{class:"historico-title"},"HistÃ³rico de Notas de Venta",-1)),a(t(D),{value:m.value,loading:l.value,responsiveLayout:"scroll",class:"historico-table"},{default:n(()=>[a(t(c),{field:"id",header:"Folio"}),a(t(c),{field:"cliente_nombre",header:"Cliente"}),a(t(c),{field:"fecha",header:"Fecha"},{body:n(e=>{var i;return[g(h(((i=e.data.fecha)==null?void 0:i.split("T")[0])||e.data.fecha||""),1)]}),_:1}),a(t(c),{field:"total",header:"Total"},{body:n(e=>[g(" $"+h(Number(e.data.total).toFixed(2)),1)]),_:1}),a(t(c),{header:"Acciones"},{body:n(e=>[a(t(k),{icon:"pi pi-file-pdf",label:"PDF",class:"p-button-sm p-button-success",onClick:i=>C(e.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),a(t(B),{visible:r.value,"onUpdate:visible":s[1]||(s[1]=e=>r.value=e),header:"Nota de Venta",modal:!0,class:"historico-dialog"},{default:n(()=>[v.value&&p.value&&f.value.length?(b(),F(H,{key:0,venta:v.value,cliente:p.value,articulos:f.value,empresa:V,"venta-registrada":!0},null,8,["venta","cliente","articulos"])):S("",!0),a(t(k),{label:"Cerrar",icon:"pi pi-times",onClick:s[0]||(s[0]=e=>r.value=!1),class:"mt-3"})]),_:1},8,["visible"])]))}},z=y(E,[["__scopeId","data-v-25a1a7b3"]]);export{z as default};
